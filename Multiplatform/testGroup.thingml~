thing fragment Msgs {
	message printHello();
}

thing t1 includes Msgs {
	provided port p {
		receives printHello
	}

	statechart chrt init Active {

		state Active {
			internal event p?printHello
			action do print "[t1] Hello\n" end
		}
	}
}

thing t2 includes Msgs {
	provided port p {
		receives printHello
	}

	statechart chrt init Active {

		state Active {
			internal event p?printHello
			action do print "[t2] Hello\n" end
		}
	}
}

thing gateway includes Msgs {
	provided port listen {
		receives printHello
	}
	required port send {
		sends printHello
	}

	statechart chrt init Active {

		state Active {
			internal event listen?printHello
			action do 
				send!printHello()
				print "[gateway] msg received\n"
			end
		}
	}
}

thing sender includes Msgs {
	required port p {
		sends printHello
	}

	statechart chrt init Active {

		state Active {
			on entry do 
				p!printHello()
				print "[sender] msg sent\n"
			end
		}
	}
}

configuration fragment Y {
	instance t1 : t1
	instance t2 : t2
	instance g : gateway

	connector g.send => t1.p
	connector g.send => t2.p
}

configuration testGroupCfg {
	group g1 : Y
	group g2 : Y
	instance s1 : sender
	instance s2 : sender

	connector s.p => g1.g.listen
	//connector s.p => g2.g.listen

	//connector s2.p => g1.g.listen
	connector s2.p => g2.g.listen

}
